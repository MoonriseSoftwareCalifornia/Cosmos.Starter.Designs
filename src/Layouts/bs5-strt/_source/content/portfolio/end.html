<!-- Portfolio Page JavaScript -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Portfolio filtering functionality
    const filterBtns = document.querySelectorAll('.filter-btn');
    const portfolioItems = document.querySelectorAll('.portfolio-item');
    const portfolioGrid = document.getElementById('portfolio-grid');
    
    // Filter portfolio items
    filterBtns.forEach(btn => {
        btn.addEventListener('click', function() {
            const filterValue = this.getAttribute('data-filter');
            
            // Update active button
            filterBtns.forEach(b => b.classList.remove('active'));
            this.classList.add('active');
            
            // Add loading state
            portfolioGrid.classList.add('portfolio-grid-loading');
            
            setTimeout(() => {
                // Filter items
                portfolioItems.forEach(item => {
                    if (filterValue === 'all' || item.getAttribute('data-category') === filterValue) {
                        item.classList.remove('hidden');
                    } else {
                        item.classList.add('hidden');
                    }
                });
                
                // Remove loading state
                portfolioGrid.classList.remove('portfolio-grid-loading');
            }, 300);
        });
    });
    
    // Smooth scrolling for anchor links
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
            e.preventDefault();
            const target = document.querySelector(this.getAttribute('href'));
            if (target) {
                target.scrollIntoView({
                    behavior: 'smooth',
                    block: 'start'
                });
            }
        });
    });
    
    // Animate statistics on scroll
    const observerOptions = {
        threshold: 0.5,
        rootMargin: '0px 0px -100px 0px'
    };
    
    const statsObserver = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                const statNumbers = entry.target.querySelectorAll('.stat-number');
                statNumbers.forEach(stat => {
                    animateNumber(stat);
                });
                statsObserver.unobserve(entry.target);
            }
        });
    }, observerOptions);
    
    const statsSection = document.querySelector('.bg-light');
    if (statsSection) {
        statsObserver.observe(statsSection);
    }
    
    // Number animation function
    function animateNumber(element) {
        const finalNumber = element.textContent;
        const isPercentage = finalNumber.includes('%');
        const isPlus = finalNumber.includes('+');
        const isSlash = finalNumber.includes('/');
        
        let numericValue = parseInt(finalNumber.replace(/[^\d]/g, ''));
        
        if (isNaN(numericValue)) return;
        
        let current = 0;
        const increment = numericValue / 60; // Animation duration
        
        const timer = setInterval(() => {
            current += increment;
            if (current >= numericValue) {
                current = numericValue;
                clearInterval(timer);
            }
            
            let displayValue = Math.floor(current);
            if (isPercentage) displayValue += '%';
            if (isPlus) displayValue += '+';
            if (isSlash) displayValue = displayValue += '/7';
            
            element.textContent = displayValue;
        }, 16);
    }
    
    // Portfolio card hover effects
    const portfolioCards = document.querySelectorAll('.portfolio-card');
    portfolioCards.forEach(card => {
        card.addEventListener('mouseenter', function() {
            this.style.transform = 'translateY(-10px) scale(1.02)';
        });
        
        card.addEventListener('mouseleave', function() {
            this.style.transform = 'translateY(0) scale(1)';
        });
    });
    
    // Lazy loading for images
    const imageObserver = new IntersectionObserver((entries, observer) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                const img = entry.target;
                img.style.opacity = '0';
                img.onload = () => {
                    img.style.transition = 'opacity 0.3s ease';
                    img.style.opacity = '1';
                };
                observer.unobserve(img);
            }
        });
    });
    
    const portfolioImages = document.querySelectorAll('.portfolio-image img');
    portfolioImages.forEach(img => imageObserver.observe(img));
    
    // Search functionality (if search input is added later)
    function setupSearch() {
        const searchInput = document.getElementById('portfolio-search');
        if (searchInput) {
            searchInput.addEventListener('input', function() {
                const searchTerm = this.value.toLowerCase();
                
                portfolioItems.forEach(item => {
                    const title = item.querySelector('h5').textContent.toLowerCase();
                    const description = item.querySelector('p').textContent.toLowerCase();
                    const tags = Array.from(item.querySelectorAll('.badge')).map(badge => badge.textContent.toLowerCase());
                    
                    const matchesSearch = title.includes(searchTerm) || 
                                        description.includes(searchTerm) || 
                                        tags.some(tag => tag.includes(searchTerm));
                    
                    if (matchesSearch || searchTerm === '') {
                        item.classList.remove('hidden');
                    } else {
                        item.classList.add('hidden');
                    }
                });
            });
        }
    }
    
    // Initialize search if element exists
    setupSearch();
    
    // Keyboard navigation for filters
    filterBtns.forEach((btn, index) => {
        btn.addEventListener('keydown', function(e) {
            if (e.key === 'ArrowRight' || e.key === 'ArrowLeft') {
                e.preventDefault();
                const nextIndex = e.key === 'ArrowRight' ? 
                    (index + 1) % filterBtns.length : 
                    (index - 1 + filterBtns.length) % filterBtns.length;
                filterBtns[nextIndex].focus();
            }
            if (e.key === 'Enter' || e.key === ' ') {
                e.preventDefault();
                this.click();
            }
        });
    });
    
    // Add ARIA labels for accessibility
    filterBtns.forEach(btn => {
        btn.setAttribute('role', 'button');
        btn.setAttribute('aria-pressed', btn.classList.contains('active'));
    });
    
    // Update ARIA labels when filter changes
    const originalFilterClick = filterBtns[0].onclick;
    filterBtns.forEach(btn => {
        const originalClick = btn.onclick;
        btn.addEventListener('click', function() {
            filterBtns.forEach(b => b.setAttribute('aria-pressed', 'false'));
            this.setAttribute('aria-pressed', 'true');
        });
    });
    
    // Performance optimization: Debounce scroll events
    let scrollTimer = null;
    window.addEventListener('scroll', function() {
        if (scrollTimer) {
            clearTimeout(scrollTimer);
        }
        scrollTimer = setTimeout(function() {
            // Add any scroll-based animations here
            const scrolled = window.pageYOffset;
            const parallax = document.querySelector('.hero-bg');
            if (parallax) {
                parallax.style.transform = `translateY(${scrolled * 0.5}px)`;
            }
        }, 10);
    });
    
    // Initialize Lightbox if available
    if (typeof lightbox !== 'undefined') {
        lightbox.option({
            'resizeDuration': 200,
            'wrapAround': true,
            'showImageNumberLabel': true,
            'albumLabel': "Image %1 of %2"
        });
    }
    
    console.log('Portfolio page initialized successfully');
});

// Utility function to add more portfolio items dynamically
function addPortfolioItem(item) {
    const portfolioGrid = document.getElementById('portfolio-grid');
    const portfolioItem = document.createElement('div');
    portfolioItem.className = 'col-lg-4 col-md-6 portfolio-item';
    portfolioItem.setAttribute('data-category', item.category);
    
    portfolioItem.innerHTML = `
        <div class="portfolio-card">
            <div class="portfolio-image">
                <img src="${item.image}" alt="${item.title}" class="img-fluid">
                <div class="portfolio-overlay">
                    <div class="portfolio-overlay-content">
                        <h5 class="text-white mb-2">${item.title}</h5>
                        <p class="text-white-50 mb-3">${item.subtitle}</p>
                        <a href="${item.lightboxImage}" class="btn btn-light btn-sm me-2 lightbox-link" data-lightbox="portfolio">View Project</a>
                        <a href="${item.link}" class="btn btn-outline-light btn-sm">${item.linkText}</a>
                    </div>
                </div>
            </div>
            <div class="portfolio-info">
                <h5 class="mb-2">${item.title}</h5>
                <p class="text-muted small">${item.description}</p>
                <div class="portfolio-tags">
                    ${item.tags.map(tag => `<span class="badge bg-primary me-1">${tag}</span>`).join('')}
                </div>
            </div>
        </div>
    `;
    
    portfolioGrid.appendChild(portfolioItem);
}
</script>
